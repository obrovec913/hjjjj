"use strict";var ajaxurl=cwginstock.ajax_url;var security_error=cwginstock.security_error;var userid=cwginstock.user_id;var emptyname=cwginstock.empty_name;var emptyemail=cwginstock.empty_email;var invalidemail=cwginstock.invalid_email;var recaptcha_enabled=cwginstock.enable_recaptcha;var recaptcha_site_key=cwginstock.recaptcha_site_key;var recaptcha_verify_enabled=cwginstock.enable_recaptcha_verify;var recaptcha_secret_present=cwginstock.recaptcha_secret_present;var is_iagree=cwginstock.is_iagree_enable;var iagree_error=cwginstock.iagree_error;var is_v3_recaptcha=cwginstock.is_v3_recaptcha;var is_popup=cwginstock.is_popup;var googlerecaptcha_widget_id=null;var gtoken="";function cwginstock_recaptcha_callback(a){document.getElementsByClassName("cwgstock_button")[0].disabled=false;if(recaptcha_verify_enabled=="1"&&recaptcha_secret_present=="yes"){document.getElementsByClassName("cwg-security")[0].value=a}}var instock_notifier={init:function(){if(is_popup=="no"){instock_notifier.generate_v3_response()}jQuery(document).on("click",".cwgstock_button",this.submit_form);jQuery(".single_variation_wrap").on("show_variation",this.perform_upon_show_variation)},perform_upon_show_variation:function(c,b){var a=b.variation_id;jQuery(".cwginstock-subscribe-form").hide();jQuery(".cwginstock-subscribe-form-"+a).show();if(recaptcha_enabled=="1"){instock_notifier.onloadcallback()}},generate_v3_response:function(){if(recaptcha_enabled=="1"&&is_v3_recaptcha=="yes"){grecaptcha.ready(function(){grecaptcha.execute(recaptcha_site_key,{action:"subscribe_form"}).then(function(b){var a=document.getElementsByClassName("cwg-security");if(a.length>0){document.getElementsByClassName("cwg-security")[0].value=b;document.getElementsByClassName("cwgstock_button")[0].disabled=false;gtoken=b}})})}},is_email:function(a){var b=/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;return b.test(a)},submit_form:function(g){g.preventDefault();var a=jQuery(this);var j=jQuery(this).closest(".cwginstock-subscribe-form").find(".cwgstock_name").val();var b=jQuery(this).closest(".cwginstock-subscribe-form").find(".cwgstock_email").val();var d=jQuery(this).closest(".cwginstock-subscribe-form").find(".cwg-product-id").val();var h=jQuery(this).closest(".cwginstock-subscribe-form").find(".cwg-variation-id").val();if(j==""){jQuery(this).closest(".cwginstock-subscribe-form").find(".cwgstock_output").fadeIn();jQuery(this).closest(".cwginstock-subscribe-form").find(".cwgstock_output").html("<div class='cwginstockerror' style='color:red;'>"+emptyname+"</div>");return false}else{if(b==""){jQuery(this).closest(".cwginstock-subscribe-form").find(".cwgstock_output").fadeIn();jQuery(this).closest(".cwginstock-subscribe-form").find(".cwgstock_output").html("<div class='cwginstockerror' style='color:red;'>"+emptyemail+"</div>");return false}else{if(!instock_notifier.is_email(b)){jQuery(this).closest(".cwginstock-subscribe-form").find(".cwgstock_output").fadeIn();jQuery(this).closest(".cwginstock-subscribe-form").find(".cwgstock_output").html("<div class='cwginstockerror' style='color:red;'>"+invalidemail+"</div>");return false}if(is_iagree=="1"){if(!jQuery(this).closest(".cwginstock-subscribe-form").find(".cwg_iagree_checkbox_input").is(":checked")){jQuery(this).closest(".cwginstock-subscribe-form").find(".cwgstock_output").fadeIn();jQuery(this).closest(".cwginstock-subscribe-form").find(".cwgstock_output").html("<div class='cwginstockerror' style='color:red;'>"+iagree_error+"</div>");return false}}var i=jQuery(this).closest(".cwginstock-subscribe-form").find(".cwg-security").val();var f={action:"cwginstock_product_subscribe",product_id:d,variation_id:h,subscriber_name:j,user_email:b,user_id:userid,security:i,dataobj:cwginstock};if(jQuery.fn.block){a.closest(".cwginstock-subscribe-form").block({message:null})}else{var c=jQuery('<div id="cwg-bis-overlay"> </div>');c.appendTo(a.closest(".cwginstock-subscribe-form"))}instock_notifier.perform_ajax(f,a)}}},recaptcha_callback:function(a){var b=document.getElementsByClassName("cwg-security");if(b.length>0){document.getElementsByClassName("cwgstock_button")[0].disabled=false;if(recaptcha_verify_enabled=="1"&&recaptcha_secret_present=="yes"){document.getElementsByClassName("cwg-security")[0].value=a}}},onloadcallback:function(){if(recaptcha_enabled=="1"){if(is_v3_recaptcha=="no"){if(jQuery("#cwg-google-recaptcha").length){if(googlerecaptcha_widget_id===null){googlerecaptcha_widget_id=grecaptcha.render("cwg-google-recaptcha",{sitekey:recaptcha_site_key,callback:this.recaptcha_callback})}else{grecaptcha.reset(googlerecaptcha_widget_id);this.recaptcha_callback();googlerecaptcha_widget_id=null;instock_notifier.onloadcallback()}}}else{instock_notifier.generate_v3_response()}}},resetcallback:function(){if(recaptcha_enabled=="1"){if(is_v3_recaptcha=="no"){grecaptcha.reset();document.getElementsByClassName("cwgstock_button")[0].disabled=true}else{instock_notifier.generate_v3_response()}}},perform_ajax:function(b,a){jQuery.ajax({type:"post",url:ajaxurl,data:b,beforeSend:function(c){c.setRequestHeader("X-WP-Nonce",cwginstock.security)},success:function(c){c=c.msg;a.closest(".cwginstock-subscribe-form").find(".cwgstock_output").fadeIn(2000);a.closest(".cwginstock-subscribe-form").find(".cwgstock_output").html(c);if(jQuery.fn.block){a.closest(".cwginstock-subscribe-form").unblock()}else{a.closest(".cwginstock-subscribe-form").find("#cwg-bis-overlay").fadeOut(400,function(){a.closest(".cwginstock-subscribe-form").find("#cwg-bis-overlay").remove()})}instock_notifier.resetcallback();jQuery(document).trigger("cwginstock_success_ajax",b)},error:function(e,c,d){if(typeof e.responseJSON!=="undefined"){if(e.responseJSON.hasOwnProperty("code")){if(typeof e.responseJSON.code!=="undefined"){if((e.responseJSON.code=="rest_cookie_invalid_nonce")||(e.responseJSON.code=="cwg_nonce_verify_failed")){e.responseText=-1}}}}if(e.responseText==="-1"||e.responseText===-1){a.closest(".cwginstock-subscribe-form").find(".cwgstock_output").fadeIn(2000);a.closest(".cwginstock-subscribe-form").find(".cwgstock_output").html("<div class='cwginstockerror' style='color:red;'>"+security_error+"</div>")}if(jQuery.fn.block){a.closest(".cwginstock-subscribe-form").unblock()}else{a.closest(".cwginstock-subscribe-form").find("#cwg-bis-overlay").fadeOut(400,function(){a.closest(".cwginstock-subscribe-form").find("#cwg-bis-overlay").remove()})}instock_notifier.resetcallback();jQuery(document).trigger("cwginstock_error_ajax",b)}})}};instock_notifier.init();
